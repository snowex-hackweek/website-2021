
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thermal Infrared Remote Sensing of Snow &#8212; SnowEx Hackweek</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Downloading datasets for the thermal IR tutorial" href="thermal-ir-data-download.html" />
    <link rel="prev" title="Thermal Infrared Remote Sensing of Snow" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SnowEx Hackweek</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to SnowEx Hackweek!
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Details
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../application.html">
   Application
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../schedule.html">
   Hackweek Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../team.html">
   Our Team
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../norms/index.html">
   Hackweek Norms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../norms/CoC.html">
     Code of Conduct
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../norms/community.html">
     Learning Community
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Preparation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../preliminary/index.html">
   Preliminary Work
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../preliminary/swc.html">
     Software Carpentry Training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../preliminary/github.html">
     GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../preliminary/jupyterhub.html">
     JupyterHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../preliminary/git.html">
     Git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../preliminary/earthdata.html">
     Earthdata Login
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../preliminary/pangeo.html">
     Pangeo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../preliminary/python.html">
     Python Installation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../day_1.html">
     Day 1
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../jupyter.html">
       GitHub, Git, JupyterHub
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../core-datasets/index.html">
       SnowEx Mission and Core Data Sets
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../core-datasets/01_introduction.html">
         SnowEx Mission and Core Data Sets
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../core-datasets/02_data-package.html">
         Depths and Snow Pit Data Package Contents
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../core-datasets/03_practice-querying.html">
         Practice Querying the Snowexsql Database
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../day_2.html">
     Day 2
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../geospatial/index.html">
       Geospatial fundamentals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../geospatial/raster.html">
         Raster data
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../geospatial/vector.html">
         Vector data
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../geospatial/SNOTEL_query.html">
         Dynamic Query of SNOTEL data
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../database/index.html">
       SnowEx Database
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../database/1_getting_started_example.html">
         Introduction to the SnowEx Database
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../database/2_database_structure.html">
         How is the Database Structured?
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../database/3_forming_queries.html">
         Forming Queries
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../database/4_get_spiral_example.html">
         Forming Queries: Example Visualizng Depths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../database/5_plot_raster_example.html">
         Forming Queries: PostGIS Functions
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../database/6_exporting_data.html">
         Exporting Data
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../database/7_wrap_up.html">
         Wrap up
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../day_3.html">
     Day 3
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../lidar/index.html">
       LIDAR
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../lidar/ICESat2_tutorial.html">
         Introduction
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="index.html">
       Thermal Infrared Remote Sensing of Snow
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="#">
         Thermal Infrared Remote Sensing of Snow
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="thermal-ir-data-download.html">
         Downloading datasets for the thermal IR tutorial
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../microstructure/microstructure-tutorial.html">
       Snow Microstructure Tutorial
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../gpr/gpr.html">
       GPR
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../day_4.html">
     Day 4
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../sar/index.html">
       Synthetic Aperture Radar
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../sar/sentinel1.html">
         Sentinel-1
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sar/swesarr.html">
         SWESARR Tutorial
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sar/uavsar.html">
         UAVSAR
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../lis/index.html">
       NASA Land Information System (LIS)
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
      <label for="toctree-checkbox-14">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../lis/1_exploring_lis_output.html">
         Visualizing and Comparing LIS Output
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../lis/2_interactive_widgets.html">
         Interactive Widgets
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../camera-traps-tutorial/camera-traps-notebook.html">
       Camera Traps and Snow Applications
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../machine-learning/Machine_Learning_Tutorial.html">
       Introduction to Machine Learning
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../projects/index.html">
   Projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../projects/project_initialization.html">
     Project Initialization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../projects/project_roles.html">
     Project Roles and Responsibilities
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../bibliography.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../SnowEx_News_and_MonthlyMeetings.html">
   SnowEx News and MonthlyMeetings
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tutorials/thermal-ir/thermal-ir-tutorial.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/snowex-hackweek/website"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/snowex-hackweek/website/issues/new?title=Issue%20on%20page%20%2Ftutorials/thermal-ir/thermal-ir-tutorial.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/snowex-hackweek/website/edit/main/book/tutorials/thermal-ir/thermal-ir-tutorial.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Thermal Infrared Remote Sensing of Snow
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-1-comparing-airborne-ir-imagery-with-ground-truth-observations">
   Part 1: Comparing airborne IR imagery with ground-truth observations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#airborne-ir-imagery">
     Airborne IR imagery
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-activity">
     Bonus activity:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ground-based-temperature-observations">
     Ground-based temperature observations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-airborne-ir-against-the-ground-truth-snow-surface-temperature">
     Compare Airborne IR against the “ground truth” snow surface temperature
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-satellite-ir-remote-sensing-obsevations">
   Part 2: Satellite IR remote sensing obsevations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#satellite-ir-imagery-with-aster">
     Satellite IR imagery with ASTER
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-activity-comparing-two-thermal-ir-rasters">
       Bonus activity: comparing two thermal IR rasters
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-steps">
   Next steps:
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#project-ideas-with-these-data">
     Project ideas with these data:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-access-download-and-pre-processing">
     Data access/download and pre-processing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additional-learning-resources">
     Additional learning resources:
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="thermal-infrared-remote-sensing-of-snow">
<h1>Thermal Infrared Remote Sensing of Snow<a class="headerlink" href="#thermal-infrared-remote-sensing-of-snow" title="Permalink to this headline">¶</a></h1>
<div class="admonition-learning-objectives admonition">
<p class="admonition-title">Learning Objectives</p>
<p><strong>At the conclusion of this tutorial, you will be able to:</strong></p>
<ul class="simple">
<li><p>understand the differences between sources of thermal IR observations, the advantages and disadvantages of each, and types of research questions we can address with those observations</p></li>
<li><p>visualize point and raster thermal infrared datasets together, then compute error statistics between point and raster datasets</p></li>
<li><p>access and visualize airborne and satellite thermal infrared imagery, then scale imagery of different spatial resolutions for comparison</p></li>
</ul>
</div>
<p><strong>Download the sample datasets for this tutorial</strong></p>
<p>For ease of access during the hackweek, sample files are available for download for running the command in the cell below. (See the bonus notebook “<a class="reference internal" href="thermal-ir-data-download.html"><span class="doc std std-doc">thermal-ir-data-download.ipynb</span></a>” for more details about data access methods)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>aws s3 sync --quiet s3://snowex-data/tutorial-data/thermal-ir/ /tmp/thermal-ir/
</pre></div>
</div>
</div>
</div>
<p><strong>Import the packages we’ll need for this tutorial</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import some general-purpose packages for handling different data structures</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># for working with n-D arrays</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># for reading our csv data file and working with tabular data</span>

<span class="c1"># Import matplotlib which we&#39;ll use for plotting images and graphs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Import these packages for working with raster data</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span> <span class="c1"># xarray lets us work with n-D arrays and labeled data, such as NetCDF files</span>
<span class="kn">import</span> <span class="nn">rioxarray</span> <span class="c1"># rioxarray provides capabilities of the rasterio package to xarray, letting us easily work with files such as GeoTIFFs</span>

<span class="c1"># Import some packages for working with the SnowEx SQL database</span>
<span class="kn">from</span> <span class="nn">snowexsql.db</span> <span class="kn">import</span> <span class="n">get_db</span> <span class="c1"># Import the connection function from the snowexsql library</span>
<span class="kn">from</span>  <span class="nn">snowexsql.data</span> <span class="kn">import</span> <span class="n">SiteData</span> <span class="c1"># Import the table classes from our data module which is where our ORM classes are defined </span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span> <span class="c1"># Import some tools to build dates </span>
<span class="kn">from</span> <span class="nn">snowexsql.conversions</span> <span class="kn">import</span> <span class="n">query_to_geopandas</span> <span class="c1"># Import a useful function for plotting and saving queries! See https://snowexsql.readthedocs.io/en/latest/snowexsql.html#module-snowexsql.conversions</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="part-1-comparing-airborne-ir-imagery-with-ground-truth-observations">
<h1>Part 1: Comparing airborne IR imagery with ground-truth observations<a class="headerlink" href="#part-1-comparing-airborne-ir-imagery-with-ground-truth-observations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="airborne-ir-imagery">
<h2>Airborne IR imagery<a class="headerlink" href="#airborne-ir-imagery" title="Permalink to this headline">¶</a></h2>
<div class="figure align-default" id="twinotter1">
<a class="reference internal image-reference" href="../../_images/twinotter1.JPG"><img alt="../../_images/twinotter1.JPG" src="../../_images/twinotter1.JPG" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">The Naval Postgraduate School Twin Otter aircraft carried the UW APL thermal infrared imager and SWESARR instrument over Grand Mesa for SnowEx 2020. (Photo by Chris Chickadel)</span><a class="headerlink" href="#twinotter1" title="Permalink to this image">¶</a></p>
</div>
<p>Load IR image mosaic netcdf file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_ir</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="s1">&#39;/tmp/thermal-ir/SNOWEX2020_IR_PLANE_2020Feb08_mosaicked_2020-02-08T181915.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
/srv/conda/envs/notebook/lib/python3.8/site-packages/xarray/backends/file_manager.py in _acquire_with_cache_info(self, needs_lock)
    198             try:
--&gt; 199                 file = self._cache[self._key]
    200             except KeyError:

/srv/conda/envs/notebook/lib/python3.8/site-packages/xarray/backends/lru_cache.py in __getitem__(self, key)
     52         with self._lock:
---&gt; 53             value = self._cache[key]
     54             self._cache.move_to_end(key)

KeyError: [&lt;function open at 0x7fc05a13d550&gt;, (&#39;/tmp/thermal-ir/SNOWEX2020_IR_PLANE_2020Feb08_mosaicked_2020-02-08T181915.tif&#39;,), &#39;r&#39;, ()]

During handling of the above exception, another exception occurred:

CPLE_OpenFailedError                      Traceback (most recent call last)
rasterio/_base.pyx in rasterio._base.DatasetBase.__init__()

rasterio/_shim.pyx in rasterio._shim.open_dataset()

rasterio/_err.pyx in rasterio._err.exc_wrap_pointer()

CPLE_OpenFailedError: /tmp/thermal-ir/SNOWEX2020_IR_PLANE_2020Feb08_mosaicked_2020-02-08T181915.tif: No such file or directory

During handling of the above exception, another exception occurred:

RasterioIOError                           Traceback (most recent call last)
&lt;ipython-input-3-206612193a33&gt; in &lt;module&gt;
----&gt; 1 airborne_ir = xr.open_rasterio(&#39;/tmp/thermal-ir/SNOWEX2020_IR_PLANE_2020Feb08_mosaicked_2020-02-08T181915.tif&#39;)

/srv/conda/envs/notebook/lib/python3.8/site-packages/xarray/backends/rasterio_.py in open_rasterio(filename, parse_coordinates, chunks, cache, lock)
    274 
    275     manager = CachingFileManager(rasterio.open, filename, lock=lock, mode=&quot;r&quot;)
--&gt; 276     riods = manager.acquire()
    277     if vrt_params is not None:
    278         riods = WarpedVRT(riods, **vrt_params)

/srv/conda/envs/notebook/lib/python3.8/site-packages/xarray/backends/file_manager.py in acquire(self, needs_lock)
    179             An open file object, as returned by ``opener(*args, **kwargs)``.
    180         &quot;&quot;&quot;
--&gt; 181         file, _ = self._acquire_with_cache_info(needs_lock)
    182         return file
    183 

/srv/conda/envs/notebook/lib/python3.8/site-packages/xarray/backends/file_manager.py in _acquire_with_cache_info(self, needs_lock)
    203                     kwargs = kwargs.copy()
    204                     kwargs[&quot;mode&quot;] = self._mode
--&gt; 205                 file = self._opener(*self._args, **kwargs)
    206                 if self._mode == &quot;w&quot;:
    207                     # ensure file doesn&#39;t get overriden when opened again

/srv/conda/envs/notebook/lib/python3.8/site-packages/rasterio/env.py in wrapper(*args, **kwds)
    433 
    434         with env_ctor(session=session):
--&gt; 435             return f(*args, **kwds)
    436 
    437     return wrapper

/srv/conda/envs/notebook/lib/python3.8/site-packages/rasterio/__init__.py in open(fp, mode, driver, width, height, count, crs, transform, dtype, nodata, sharing, **kwargs)
    218         # None.
    219         if mode == &#39;r&#39;:
--&gt; 220             s = DatasetReader(path, driver=driver, sharing=sharing, **kwargs)
    221         elif mode == &quot;r+&quot;:
    222             s = get_writer_for_path(path, driver=driver)(

rasterio/_base.pyx in rasterio._base.DatasetBase.__init__()

RasterioIOError: /tmp/thermal-ir/SNOWEX2020_IR_PLANE_2020Feb08_mosaicked_2020-02-08T181915.tif: No such file or directory
</pre></div>
</div>
</div>
</div>
<p>Inspect the contents of the file we just opened</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_ir</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span> <span class="c1"># original CRS</span>
</pre></div>
</div>
</div>
</div>
<p>Under the dataarray’s attributes we can see that we have a coordinate reference system already defined (crs) as <a class="reference external" href="https://epsg.io/32612">EPSG:32612</a>. We can also find this through <code class="docutils literal notranslate"><span class="pre">da.rio.crs</span></code>.</p>
<p>However, we would like to reproject this into the common projection used by datasets on the SnowEx SQL database: <a class="reference external" href="https://epsg.io/26912">EPSG:26912</a>. We can do that using rioxarray’s <a class="reference external" href="https://corteva.github.io/rioxarray/stable/rioxarray.html#rioxarray.raster_array.RasterArray.reproject">reproject</a> method (see an example <a class="reference external" href="https://corteva.github.io/rioxarray/stable/examples/reproject.html">here</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_ir</span> <span class="o">=</span> <span class="n">airborne_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="s1">&#39;EPSG:26912&#39;</span><span class="p">)</span> <span class="c1"># overwrite itself with new reprojected data array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span> <span class="c1"># new CRS</span>
</pre></div>
</div>
</div>
</div>
<p>Next, the filename shows us when this imagery was taken in UTC time, “2020-02-08T181915”</p>
<p>We can create a pandas timestamp variable in local time for comparison with other datasets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a pandas timestamp, subtract 7 hours from UTC time to get local time (MST, UTC-7)</span>
<span class="n">airborne_ir_timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What color scale should we use for temperature?</p>
<p>Common advice you may have heard is to <a class="reference external" href="https://jakevdp.github.io/blog/2014/10/16/how-bad-is-your-colormap/">avoid using rainbow color scales</a>. Luckily <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">matplotlib gives us lots of options</a> to choose from.</p>
<p>When representing images of temperature, sometimes we want to pick colors that intuitively suggest temperature, such as the “magma” colorbar below. Other times we might be interested in both magnitude and sign, such as temperatures above or below melting point, in which case we could use something like “RdBu_r” below. I often pick simple greyscale, though less visually interesting, it is sometimes easier to pick out details in a continuous color scale like they “Greys” scale below. <strong>Make sure to include a labeled colorbar so your plot can be correctly interpreted!</strong></p>
<div class="figure align-default" id="colorbars">
<a class="reference internal image-reference" href="../../_images/colorbars.png"><img alt="../../_images/colorbars.png" src="../../_images/colorbars.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Some matplotlib color scale options (top to bottom): “magma”, “RdBu_r”, “Greys”</span><a class="headerlink" href="#colorbars" title="Permalink to this image">¶</a></p>
</div>
</div>
<p>Plot the airborne TIR image.</p>
<ul class="simple">
<li><p>What does our chosen colorscale tell us about temperatures here?</p></li>
<li><p>What can we see?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># create a new matplotlib figure, set the figure size</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>

<span class="c1"># plot the airborne infrared image</span>
<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>

<span class="c1"># set axes labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne TIR imagery of Grand Mesa, CO (Feb. 8, 2020)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="hint admonition">
<p class="admonition-title">Image interpretation</p>
<ul class="simple">
<li><p>What does our chosen colorscale tell us about temperatures here?</p>
<ul>
<li><p>The colorbar on the right shows us that colder temperatures are represented with dark purple to black colors.</p></li>
<li><p>Warmer temperatures are represented with lighter orange/yellow.</p></li>
</ul>
</li>
<li><p>What can we see?</p>
<ul>
<li><p>We see a narrow stripe of imagery, this is a mosaic of individual camera images taken from the aircraft along a single flight line over Grand Mesa.</p></li>
<li><p>On the left (west) side of the image we see warmer but varied temperatures (yellow, orange, and purple), then an abrupt transition to uniformly cold temperatures (purple). This is the westernmost edge of the mesa where the snow on top is much colder than the lower elevation slopes of the mountain.</p></li>
<li><p>Continuing to move from left (west) to right (east) we see patches of lighter colors, corresponding with warmer temperatures. These are patches of forest on the central and eastern portions of the mesa.</p></li>
<li><p>Finally near the easternmost side of the image we see a very dark region that means it is much colder than the rest of the scene. What might this cold area or object be?</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="bonus-activity">
<h2>Bonus activity:<a class="headerlink" href="#bonus-activity" title="Permalink to this headline">¶</a></h2>
<p>To help with our image interpretation, we can load visible imagery taken concurrently from the UW-APL airborne instrument. (Note: this example image is a single band black and white image, though we also have full RGB images available through NSIDC)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_vis</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="s1">&#39;/tmp/thermal-ir/SNOWEX2020_EO_PLANE_2020Feb08_mosaicked_2020-02-08T181915.tif&#39;</span><span class="p">)</span>

<span class="c1"># note that the filename is identical with the same timestamp, but is labeled &quot;EO&quot; (electro-optical) rather than &quot;IR&quot; (infrared)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Also reproject the airborne visible imagery into EPSG:26912</span>
<span class="n">airborne_vis</span> <span class="o">=</span> <span class="n">airborne_vis</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="s1">&#39;EPSG:26912&#39;</span><span class="p">)</span> <span class="c1"># overwrite itself with new reprojected data array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_vis</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the visible and infrared images side by side. This time, we will change the x and y axes limits (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html">set_xlim</a>, and <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html">set_ylim</a>) to zoom in closer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot the IR imagery</span>
<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                 <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne IR&#39;</span><span class="p">)</span>

<span class="c1"># Plot the visible imagery</span>
<span class="n">airborne_vis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span>
                  <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;DN&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne Vis&#39;</span><span class="p">)</span>

<span class="c1"># for each subplot, do the following:</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>
    
    <span class="c1"># give each axis a label</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>
    
    <span class="c1"># set the axes limits, units in meters UTM Zone 12N (I chose these values by just looking at the plot above)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">735000</span><span class="p">,</span> <span class="mi">760000</span><span class="p">))</span> <span class="c1"># x axis limits</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">4320000</span><span class="p">,</span> <span class="mi">4325000</span><span class="p">))</span> <span class="c1"># y axis limits</span>
</pre></div>
</div>
</div>
</div>
<div class="hint admonition">
<p class="admonition-title">Image interpretation</p>
<ul class="simple">
<li><p>The visible imagery camera covers a slightly narrower width along the flight path than the IR cameras.</p></li>
<li><p>Now what do you think the cold object on the eastern side of the image is?</p></li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="section" id="ground-based-temperature-observations">
<h2>Ground-based temperature observations<a class="headerlink" href="#ground-based-temperature-observations" title="Permalink to this headline">¶</a></h2>
<p>To provide a source of “ground truth” for the airborne and satellite thermal infrared images during the SnowEx 2020 Grand Mesa campaign, we can use ground-based snow surface temperature measurements. On February 5, 2020, we installed a thermal infrared radiometer pointing at the snow surface at snow pit #2S10 (left), and buried temperature sensors beneath the snow surface (right). These logged observations at 5-minute intervals until we removed the instrumentation a week later on February 12.</p>
<div class="figure align-default" id="snowpit">
<a class="reference internal image-reference" href="../../_images/snowpit_2s10.png"><img alt="../../_images/snowpit_2s10.png" src="../../_images/snowpit_2s10.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Snow temperature sensor setup at snow pit 2S10: (left) tripod-mounted thermal ifrared radiometer to measure snow surface, (right) temperature probes to be buried beneath the snow surface.<br/>(Photos by Steven Pestana)</span><a class="headerlink" href="#snowpit" title="Permalink to this image">¶</a></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What are some of the differences we might expect to see between the ground-based surface temperature data and the thermal IR images?</p>
<ul class="simple">
<li><p><em>Emissivity differences?</em></p>
<ul>
<li><p>Our ground-based radiometer was looking at 45 deg off nadir, versus nadir ASTER versus variable view angle airborne (snow emissivity changes off-nadir)</p></li>
</ul>
</li>
<li><p><em>Different TIR bandwidths (broad versus narrow)?</em></p>
<ul>
<li><p>Ground-based radiometer: 8-14 μm, Airborne IR cameras: 8-14 μm, ASTER band 14: 10.95-11.65 µm</p></li>
</ul>
</li>
<li><p><em>Different atmospheric path lengths?</em></p>
<ul>
<li><p>From &lt;1 meter, to 1 km, to entire atmospheric column (~100 km)</p></li>
</ul>
</li>
<li><p><em>“Point” versus area, and geolocation accuracy</em></p>
<ul>
<li><p>The ground-based radiometer is measuring temperature for a spot (not really a single point) maybe ~1m in diameter. The airborne and ASTER imagers have spatial resolutions of 5m and 90m respectively. How confident are we in the geolocation of individual pixels in the imagery?</p></li>
</ul>
</li>
</ul>
</div>
<p><strong>Where is snow pit 2S10?</strong></p>
<p>We can find this information through a query to the SnowEx SQL database. First, set up the connection:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is what you will use for all of hackweek to access the db</span>
<span class="n">db_name</span> <span class="o">=</span> <span class="s1">&#39;snow:hackweek@52.32.183.144/snowex&#39;</span>
<span class="c1"># Using the function get_db, we receive 2 ways to interact with the database</span>
<span class="n">engine</span><span class="p">,</span> <span class="n">session</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">(</span><span class="n">db_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then, query <a class="reference external" href="https://snowexsql.readthedocs.io/en/latest/database_structure.html#sites-table">SiteData</a> using <a class="reference external" href="https://docs.sqlalchemy.org/en/14/orm/query.html#sqlalchemy.orm.Query.filter_by">filter_by</a> to find the entry with the site ID that we want (2S10). Preview the resulting geodataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Form the query to receive site_id=&#39;2S10&#39; from the sites table</span>
<span class="n">qry</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SiteData</span><span class="p">)</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="s1">&#39;2S10&#39;</span><span class="p">)</span>

<span class="c1"># Convert the record received into a geopandas dataframe</span>
<span class="n">siteData_df</span> <span class="o">=</span> <span class="n">query_to_geopandas</span><span class="p">(</span><span class="n">qry</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="c1"># Preview the resulting geopandas dataframe</span>
<span class="n">siteData_df</span>
</pre></div>
</div>
</div>
</div>
<p>Inspect of the geodatframe’s metadata</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># What is the coordinate reference system used here?</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">crs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preview the geometry of this geodataframe, we should see that it is a POINT</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">geometry</span>
</pre></div>
</div>
</div>
</div>
<p>We can now plot our snow pit site from this <a class="reference external" href="https://geopandas.org/docs/reference/api/geopandas.GeoDataFrame.plot.html">geodataframe</a> on top of the airborne IR image. (See more tips about plotting geodataframes <a class="reference external" href="https://www.earthdatascience.org/courses/scientists-guide-to-plotting-data-in-python/plot-spatial-data/customize-vector-plots/python-change-spatial-extent-of-map-matplotlib-geopandas/">here</a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># create a new matplotlib figure, set the figure size</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>

<span class="c1"># plot the airborne infrared image</span>
<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>

<span class="c1"># plot the location of the snow pit of interest</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># set axes labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>

<span class="c1"># set the axes limits, units in meters UTM Zone 12N (I chose these values by just looking at the plot above)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">735000</span><span class="p">,</span> <span class="mi">760000</span><span class="p">))</span> <span class="c1"># x axis limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">4320000</span><span class="p">,</span> <span class="mi">4325000</span><span class="p">))</span> <span class="c1"># y axis limits</span>

<span class="c1"># set plot title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Location of Snow Pit 2S10</span><span class="se">\n</span><span class="s1">with Airborne TIR imagery of Grand Mesa, CO (Feb. 8, 2020)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Change the x and y axes limits (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html">set_xlim</a>, and <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html">set_ylim</a>) to zoom in to our point of interest. In this case we can use <a class="reference external" href="https://geopandas.readthedocs.io/en/latest/docs/reference/api/geopandas.GeoSeries.total_bounds.html">df.geometry.total_bounds</a> to get the x and y values that define the area our geometry takes up. (In this case we have a point so it will return just the point’s location, but this would work if we had a polygon as well)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># create a new matplotlib figure, set the figure size</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>

<span class="c1"># plot the airborne infrared image</span>
<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>

<span class="c1"># plot the location of the snow pit of interest</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># set axes limits</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">siteData_df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">total_bounds</span> <span class="c1"># get the &quot;total bounds&quot; for our geometry</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># x axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># y axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>

<span class="c1"># set axes labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>

<span class="c1"># set plot title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Location of Snow Pit 2S10</span><span class="se">\n</span><span class="s1">Airborne TIR imagery of Grand Mesa, CO (Feb. 8, 2020)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Import the snow temperature timeseries dataset</strong></p>
<p>This data is <a class="reference external" href="https://nsidc.org/data/SNEX20_VPTS_Raw/versions/1">available through NSIDC</a>, but we have already downloaded a local copy for this tutorial. (See the bonus notebook <a class="reference internal" href="thermal-ir-data-download.html"><span class="doc std std-doc">thermal-ir-data-download.ipynb</span></a> for more details about data access methods)</p>
<p>The raw data file doesn’t include the column names, so we need to set the column headers following the dataset’s README file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat /tmp/thermal-ir/SNEX20_VPTS_Raw/Level-0/snow-temperature-timeseries/README.txt
</pre></div>
</div>
</div>
</div>
<p>Create a list of column headers according to the readme above (for “GM1” which we can read was the datalogger at snowpit 2S10)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;doy&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="c1"># year, day of year, time of day (local time, UTC-7)</span>
                  <span class="s1">&#39;rad_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;rad_max&#39;</span><span class="p">,</span> <span class="s1">&#39;rad_min&#39;</span><span class="p">,</span> <span class="s1">&#39;rad_std&#39;</span><span class="p">,</span> <span class="c1"># radiometer surface temperature</span>
                  <span class="s1">&#39;sb_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;sb_max&#39;</span><span class="p">,</span> <span class="s1">&#39;sb_min&#39;</span><span class="p">,</span> <span class="s1">&#39;sb_std&#39;</span><span class="p">,</span> <span class="c1"># radiometer sensor body temperature (for calibration)</span>
                  <span class="s1">&#39;temp1_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;temp1_max&#39;</span><span class="p">,</span> <span class="s1">&#39;temp1_min&#39;</span><span class="p">,</span> <span class="s1">&#39;temp1_std&#39;</span><span class="p">,</span> <span class="c1"># temperature at 5 cm below snow surface</span>
                  <span class="s1">&#39;temp2_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;temp2_max&#39;</span><span class="p">,</span> <span class="s1">&#39;temp2_min&#39;</span><span class="p">,</span> <span class="s1">&#39;temp2_std&#39;</span><span class="p">,</span> <span class="c1">#               10 cm</span>
                  <span class="s1">&#39;temp3_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;temp3_max&#39;</span><span class="p">,</span> <span class="s1">&#39;temp3_min&#39;</span><span class="p">,</span> <span class="s1">&#39;temp3_std&#39;</span><span class="p">,</span> <span class="c1">#               15 cm</span>
                  <span class="s1">&#39;temp4_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;temp4_max&#39;</span><span class="p">,</span> <span class="s1">&#39;temp4_min&#39;</span><span class="p">,</span> <span class="s1">&#39;temp4_std&#39;</span><span class="p">,</span> <span class="c1">#               20 cm</span>
                  <span class="s1">&#39;temp5_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;temp5_max&#39;</span><span class="p">,</span> <span class="s1">&#39;temp5_min&#39;</span><span class="p">,</span> <span class="s1">&#39;temp5_std&#39;</span><span class="p">,</span> <span class="c1">#               30 cm</span>
                  <span class="s1">&#39;batt_a&#39;</span><span class="p">,</span><span class="s1">&#39;batt_b&#39;</span><span class="p">,</span> <span class="c1"># battery voltage data</span>
                 <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Open the file as a pandas data frame with <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">read_csv</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/tmp/thermal-ir/SNEX20_VPTS_Raw/Level-0/snow-temperature-timeseries/CR10X_GM1_final_storage_1.dat&#39;</span><span class="p">,</span>
                 <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">column_headers</span><span class="p">)</span> 

<span class="c1"># After the filepath we specify header=None because the file doesn&#39;t contain column headers, </span>
<span class="c1"># then we specify names=column_headers to give our own names for each column.</span>
</pre></div>
</div>
</div>
</div>
<p>We need to do some formatting of the data fields, but we can preview what we just loaded fist</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># show the first 5 rows of the dataframe</span>
</pre></div>
</div>
</div>
</div>
<p>Data cleanup and formatting</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a zero-padded time string (e.g. for 9:30 AM we are changing &#39;930&#39; into &#39;0930&#39;)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;0&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]))))</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="c1"># change midnight from &#39;2400&#39; to &#39;0000&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">time_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;2400&#39;</span><span class="p">,</span> <span class="s1">&#39;0000&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This function lets us convert year and day of year (the format that the datalogger uses) to a pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DatetimeIndex.html">datetime index</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compose_date</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">months</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weeks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hours</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minutes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">seconds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">milliseconds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">microseconds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nanoseconds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Compose a datetime object from various datetime components. This clever solution is from:</span>
<span class="sd">        https://stackoverflow.com/questions/34258892/converting-year-and-day-of-year-into-datetime-index-in-pandas&#39;&#39;&#39;</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1970</span>
    <span class="n">months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">months</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">days</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&lt;M8[Y]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[M]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[D]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[W]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[h]&#39;</span><span class="p">,</span>
             <span class="s1">&#39;&lt;m8[m]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[ms]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[us]&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;m8[ns]&#39;</span><span class="p">)</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">weeks</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span><span class="p">,</span>
            <span class="n">milliseconds</span><span class="p">,</span> <span class="n">microseconds</span><span class="p">,</span> <span class="n">nanoseconds</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">types</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>
               <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a datetime value from the date field and zero-padded time_str field, set this as our dataframe&#39;s index</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">compose_date</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> 
                        <span class="n">days</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;doy&#39;</span><span class="p">],</span> 
                        <span class="n">hours</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span>
                        <span class="n">minutes</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

<span class="c1"># Remove entries that are from table &quot;102&quot; (this contains datalogger battery information we&#39;re not interested in at the moment)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">table</span> <span class="o">!=</span> <span class="mi">102</span><span class="p">]</span>

<span class="c1"># drop the columns we no longer need</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;doy&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;time_str&#39;</span><span class="p">,</span><span class="s1">&#39;batt_a&#39;</span><span class="p">,</span><span class="s1">&#39;batt_b&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Inspect the contents</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Make a simple plot of the data. We are interested in the variable <code class="docutils literal notranslate"><span class="pre">rad_avg</span></code> which is the average temperature measured by the radiometer over each 5 minute period.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># plot radiometer average temperature</span>
<span class="n">df</span><span class="o">.</span><span class="n">rad_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ground-based $T_s$&#39;</span><span class="p">)</span>

<span class="c1"># set axes limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">35</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>

<span class="c1"># add a legend to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># set axes labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$C\degree$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

<span class="c1"># add grid lines to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>

<span class="c1"># set the plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Snow Surface Temperature at Snow Pit 2S10&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Bonus plot: look at snow temperatures below the snow surface</p>
<p>Add the following to the above plot to add lines for temperature recorded at each depth interval below the snow surface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the snow temperature at each depth it was measured</span>
<span class="n">df</span><span class="o">.</span><span class="n">temp1_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ts @ -5 cm&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">temp2_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ts @ -10 cm&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">temp3_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ts @ -15 cm&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">temp4_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ts @ -20 cm&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">temp5_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ts @ -30 cm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>But then we want to focus on the date/time when our IR image was from, so zoom in on Feb 8th by changing our plot’s <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html">xlim</a> (using pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Timestamp.html">Timestamps</a> for the x axis values).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># plot radiometer average temperature</span>
<span class="n">df</span><span class="o">.</span><span class="n">rad_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ground-based $T_s$&#39;</span><span class="p">)</span>

<span class="c1"># set axes limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># set some temperature y-axis limits for our plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="c1"># zoom in to daytime hours on Feb. 8, 2020</span>

<span class="c1"># add a legend to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># set axes labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$C\degree$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

<span class="c1"># add grid lines to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>

<span class="c1"># set the plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Snow Surface Temperature at Snow Pit 2S10&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="compare-airborne-ir-against-the-ground-truth-snow-surface-temperature">
<h2>Compare Airborne IR against the “ground truth” snow surface temperature<a class="headerlink" href="#compare-airborne-ir-against-the-ground-truth-snow-surface-temperature" title="Permalink to this headline">¶</a></h2>
<p><strong>What is the temperature at this point in the airborne IR image?</strong></p>
<p>Use rioxarray’s <a class="reference external" href="https://corteva.github.io/rioxarray/stable/examples/clip_geom.html">clip</a> function to extract the raster values that intersect with the point’s geometry. Because we have a point, this will return a single value for the pixel that overlaps this point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># clip using our point&#39;s geometry</span>
<span class="n">airborne_ir_point_temperature</span> <span class="o">=</span> <span class="n">airborne_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">siteData_df</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>

<span class="c1"># preview the result</span>
<span class="n">airborne_ir_point_temperature</span>
</pre></div>
</div>
</div>
</div>
<p>Our result is a DataArray with a single data value at one set of x and y coordinates.</p>
<div class="admonition-pixel-point admonition">
<p class="admonition-title">Pixel = Point ?</p>
<p>Should we expect that the temperature measured for an image pixel would be the same for an individual point on the ground? The airborne imagery is at 5 meter spatial resolution, whereas our ground-based radiometer measured a spot maybe only ~1 m in diameter. Additionally, the geolocation of the airborne imagery is less accurate than 5 meters (closer to 10-15 meters) meaning that if we picked a single pixel to overlap our ground point, it may be the wrong pixel. Let’s instead look at the average and distribution of temperatures from the airborne imagery in an area around this point.</p>
</div>
<p>Add a 100 m radius <a class="reference external" href="https://geopandas.org/docs/reference/api/geopandas.GeoSeries.buffer.html">buffer</a> around this point and get the temperature from the airborne imagery for a larger area around the snow pit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># radius of the buffer in meters (this is in meters because we are working in a UTM coordinate reference system)</span>

<span class="c1"># create the buffered geometry</span>
<span class="n">siteData_df_buffer</span> <span class="o">=</span> <span class="n">siteData_df</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># preview the resulting geometry, we should see this is a POLYGON now</span>
<span class="n">siteData_df_buffer</span>
</pre></div>
</div>
</div>
</div>
<p>What does this polygon look like when we plot it on top of the airborne IR image now?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># create a new matplotlib figure, set the figure size</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>

<span class="c1"># plot the airborne infrared image</span>
<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>

<span class="c1"># plot the location of the snow pit of interest</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># plot the area of the buffer we made around the snow pit</span>
<span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="c1"># set the same axes limits as above</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># x axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># y axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>

<span class="c1"># set axes labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>

<span class="c1"># set plot title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Location of Snow Pit 2S10, and 100 m radius buffer</span><span class="se">\n</span><span class="s1">with ASTER Band 14 TIR imagery&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Clip the airborne IR raster again, now with our 200 m diameter polygon around the snow pit site.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># clip using our new geometry</span>
<span class="n">airborne_ir_area_temperature</span> <span class="o">=</span> <span class="n">airborne_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>

<span class="c1"># preview the result</span>
<span class="n">airborne_ir_area_temperature</span>
</pre></div>
</div>
</div>
</div>
<p>The result of clipping is again a DataArray, this time though it is 40x40. We can plot this to see what it looks like, and to see the distribution of temperatures in the area.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># plot the portion of the airborne TIR image we selected within the buffer area geometry</span>
<span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">7</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne TIR image within</span><span class="se">\n</span><span class="s1">100 m radius buffer (2S10)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">150</span><span class="p">))</span> <span class="c1"># x axis limits to +/- 150 m from our point&#39;s &quot;total bounds&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">150</span><span class="p">))</span> <span class="c1"># y axis limits to +/- 150 m from our point&#39;s &quot;total bounds&quot;</span>

<span class="c1"># plot the location of the snow pit of interest to the plot</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># plot the area of the buffer we made around the snow pit</span>
<span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="c1"># plot a histogram of image temperature data within the buffer area geometry</span>
<span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                       <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># use zorder to make sure this plots below the point</span>
                                       <span class="n">label</span><span class="o">=</span><span class="s1">&#39;zonal $T_S$ histogram&#39;</span><span class="p">)</span> 

<span class="c1"># plot a vertical line for the single-pixel temperature we think is right at the snow pit</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">airborne_ir_point_temperature</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>  <span class="c1"># set color and style</span>
              <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1"># use zorder to make sure this plots on top of the histogram</span>
              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T_S$ single pixel&#39;</span><span class="p">)</span> 

<span class="c1"># plot a vertical line for the mean temperature within the buffer area geometry</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>  <span class="c1"># set color and style</span>
              <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1"># use zorder to make sure this plots on top of the histogram</span>
              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;zonal mean $T_S$&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span> <span class="c1"># add a legend</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># set xlim to same values as colorbar in image plot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span> <span class="c1"># set ylim</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Snow surface temperatures</span><span class="se">\n</span><span class="s1">from Airborne TIR image (snow pit 2S10)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of pixels&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What do these plots tell us about the surface temperature around the snow pit as measured by the airborne IR cameras?</p>
<ul class="simple">
<li><p>Is the snow surface temperature more variable or uniform in this area?</p>
<ul>
<li><p>Note that we changed the minimum and maximum values of our colorbar!</p></li>
<li><p>Try computing the standard deviation of temperatures in this area</p></li>
</ul>
</li>
<li><p>How does our single pixel at the center compare with the rest of this area?</p>
<ul>
<li><p>Try taking the mean or median of all temperatures in the area and compare against the single point. What is the difference?</p></li>
</ul>
</li>
<li><p>See <a class="reference external" href="https://doi.org/10.1016/j.rse.2018.03.001">Lundquist et al., 2018</a> for an application of these methods with airborne and MODIS thermal infrared imagery</p></li>
</ul>
</div>
<p><strong>Plot the airborne IR temperature data on top of the ground-based timeseries</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># plot radiometer average temperature</span>
<span class="n">df</span><span class="o">.</span><span class="n">rad_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ground-based $T_s$&#39;</span><span class="p">)</span>

<span class="c1"># plot the mean airborne IR temperature from the area around the snow pit:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">airborne_ir_timestamp</span><span class="p">,</span> <span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Airborne IR mean $T_s$ for 100 m radius area&#39;</span><span class="p">)</span>

<span class="c1"># plot an error bar showing the maximum and minimum airborne IR temperature around the snow pit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">airborne_ir_timestamp</span><span class="p">,</span> <span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
             <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">min</span><span class="p">()],</span> 
                   <span class="p">[</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()]],</span>
            <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Airborne IR $T_s$ range for 100 m radius area&#39;</span><span class="p">)</span>


<span class="c1"># set axes limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="c1"># zoom in to daytime hours on Feb. 8, 2020</span>

<span class="c1"># add a legend to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># set axes labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$C\degree$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

<span class="c1"># add grid lines to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>

<span class="c1"># set the plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Snow Surface Temperature at Snow Pit 2S10&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Continuing with this analysis:</p>
<p>In the above plot we’ve added “error bars” to represent the full range of temperatures within the 100 m radius area around the snow pit.</p>
<ul class="simple">
<li><p>Is this a fair comparison?</p></li>
<li><p>Should we make the area smaller based on our confidence in the image’s geolocation accuracy (10-15 m)?</p></li>
<li><p>What is the difference between the “ground truth” data and the airborne IR data at this point in time?</p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="part-2-satellite-ir-remote-sensing-obsevations">
<h1>Part 2: Satellite IR remote sensing obsevations<a class="headerlink" href="#part-2-satellite-ir-remote-sensing-obsevations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="satellite-ir-imagery-with-aster">
<h2>Satellite IR imagery with ASTER<a class="headerlink" href="#satellite-ir-imagery-with-aster" title="Permalink to this headline">¶</a></h2>
<p><strong>Advantages of satellite IR images:</strong> We don’t always have airplanes with IR cameras flying around. Satellites can provide images at more regular intervals for long-term studies, and can see areas that are difficult to access on the ground or by air.</p>
<div class="dropdown admonition">
<p class="admonition-title">What might be some diadvantages of satellite IR imagery compared to airborne IR imagery?</p>
<ul class="simple">
<li><p>Lower spatial resolution because they’re further away from the Earth’s surface</p></li>
<li><p>Mixed pixel problem: with lower image resolutions, each pixel contains a more heterogeneous mixtures of surfaces and temperatures, meaning that temperature information is more blurred together</p></li>
<li><p>What other disadvantages can you think of?</p></li>
<li><p>How might these differences (advantages or disadvantages) change the type of research questions you can investigate?</p></li>
</ul>
</div>
<p>For this tutorial, we will look at an image from NASA’s <a class="reference external" href="https://asterweb.jpl.nasa.gov/">Advanced Spaceborne Thermal Emission and Reflection Radiometer</a> (ASTER) imager, which is onboard the Terra satellite along with a MODIS imager. We can compare an ASTER IR image of Grand Mesa that was taken at roughly the same time as the airborne IR image. The ASTER image we will be working with is from ASTER’s <a class="reference external" href="https://asterweb.jpl.nasa.gov/characteristics.asp">band 14</a> which is sensitive to radiance in the 10.95-11.65 µm wavelength range.</p>
<p>Load an ASTER geotiff that we’ve downloaded for this tutorial, and inspect its contents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aster_ir</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="s1">&#39;/tmp/thermal-ir/AST_L1T_00302082020180748_20200209065849_17218_ImageData14.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Inspect the ASTER file we just opened</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aster_ir</span>
</pre></div>
</div>
</div>
</div>
<p>What is its CRS?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aster_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reproject this ASTER image into our common coordinate system</span>
<span class="n">aster_ir</span> <span class="o">=</span> <span class="n">aster_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="s1">&#39;EPSG:26912&#39;</span><span class="p">)</span> <span class="c1"># overwrite itself with new reprojected data array</span>
</pre></div>
</div>
</div>
</div>
<p>When was this image taken?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aster_ir_timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">48</span><span class="p">)</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the image. What are the units of the values on the colorbar?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aster_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>It’s necessary to read the product documentation to understand what we are looking at here.</p>
<p>We are using the <em>ASTER Level 1 Precision Terrain Corrected Registered At-Sensor Radiance</em> (AST_L1T) product. <a class="reference external" href="https://lpdaac.usgs.gov/products/ast_l1tv003/">Product documentation is available here</a>. Also helpful is the ** (AST_L1B) <a class="reference external" href="https://lpdaac.usgs.gov/products/ast_l1bv003/">product documentation here</a> from which AST_L1T is derived.</p>
<p>The values here are stored as scaled “digital number” (DN) values rather than the actual radiance values. The product documentation also provides information about how to unscale these values back into radiance units, and from radiance to brightness temperature, using laboratory calibrated constants.</p>
<p>I’ve written two functions here to do this unit conversion for the five ASTER TIR bands in two steps (DN to radiance, radiance to brightness temperature). The function takes as its arguments the DN or radiance values respectively, and the band number (in our case band number <code class="docutils literal notranslate"><span class="pre">14</span></code>, <em>not the band wavelengths</em>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tir_dn2rad</span><span class="p">(</span><span class="n">DN</span><span class="p">,</span> <span class="n">band</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Convert AST_L1T Digital Number values to At-Sensor Radiance for the TIR bands (bands 10-14).&#39;&#39;&#39;</span>
    <span class="n">ucc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">6.822e-3</span><span class="p">,</span> <span class="mf">6.780e-3</span><span class="p">,</span> <span class="mf">6.590e-3</span><span class="p">,</span> <span class="mf">5.693e-3</span><span class="p">,</span> <span class="mf">5.225e-3</span><span class="p">]</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="p">(</span><span class="n">DN</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="n">ucc</span><span class="p">[</span><span class="n">band</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rad</span>

<span class="k">def</span> <span class="nf">tir_rad2tb</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="n">band</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Convert AST_L1T At-Sensor Radiance to Brightness Temperature [K] for the TIR bands (bands 10-14).&#39;&#39;&#39;</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3047.47</span><span class="p">,</span> <span class="mf">2480.93</span><span class="p">,</span> <span class="mf">1930.80</span><span class="p">,</span> <span class="mf">865.65</span><span class="p">,</span> <span class="mf">649.60</span><span class="p">]</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1736.18</span><span class="p">,</span> <span class="mf">1666.21</span><span class="p">,</span> <span class="mf">1584.72</span><span class="p">,</span><span class="mf">1349.82</span><span class="p">,</span> <span class="mf">1274.49</span><span class="p">]</span>
    <span class="n">tb</span> <span class="o">=</span> <span class="n">k2</span><span class="p">[</span><span class="n">band</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">/</span>  <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">k1</span><span class="p">[</span><span class="n">band</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="n">rad</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tb</span>
</pre></div>
</div>
</div>
</div>
<p>Use the above functions to convert from DN to radiance, radiance to brightness temperature (assume and emissivity of 1 for all surfaces, note that the airborne imagery also assumed emissivity of 1).</p>
<p>Then convert from degeees K to degrees C by subtracting 273.15.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aster_band14_rad</span> <span class="o">=</span> <span class="n">tir_dn2rad</span><span class="p">(</span> <span class="n">aster_ir</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="mi">14</span> <span class="p">)</span> <span class="c1"># convert from DN to radiance</span>
<span class="n">aster_band14_tb_k</span> <span class="o">=</span> <span class="n">tir_rad2tb</span><span class="p">(</span> <span class="n">aster_band14_rad</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="mi">14</span> <span class="p">)</span> <span class="c1"># convert from radiance to brightness temperature (K)</span>
<span class="n">aster_band14_tb_c</span> <span class="o">=</span> <span class="n">aster_band14_tb_k</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># convert from K to C</span>

<span class="c1"># Note that an &quot;invalid value encountered...&quot; warning may pop up here. This is because the above function tries to take the log of &quot;nan&quot; values that are outside the imaged area</span>
<span class="c1"># we can ignore this warning and proceed</span>
</pre></div>
</div>
</div>
</div>
<p>During this unit conversion, xarray dropped the coordinate reference system attributes, so here we add the original crs to the new ASTER degrees celsius dataarray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aster_band14_tb_c</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">aster_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Plot our image again, this time setting our colorscale and colorbar values. We should see “realistic” surface temperature values in degrees C now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">aster_band14_tb_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                       <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="c1"># note that we have a wider temperature range on our colorbar for this image, -20 to +20 C instead of -10 to +10 C</span>
                       <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="hint admonition">
<p class="admonition-title">Image interpretation</p>
<ul class="simple">
<li><p>What does our chosen colorscale tell us about temperatures here?</p></li>
<li><p>What can we see?</p>
<ul>
<li><p>What do you think that cold linear feature across the image is? (Hint: think about the cold object we saw in the airborne IR image)</p></li>
</ul>
</li>
</ul>
</div>
<p><strong>Plot ASTER next to Airborne IR to see spatial resolution differences</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">aster_band14_tb_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                       <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                       <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ASTER IR&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>


<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                 <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne IR&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># for each subplot, do the following:</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>
    
    <span class="c1"># plot the location of the snow pit of interest</span>
    <span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="c1"># plot the area of the buffer we made around the snow pit</span>
    <span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    
    <span class="c1"># set axes labels and limits</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">735000</span><span class="p">,</span> <span class="mi">760000</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">4320000</span><span class="p">,</span> <span class="mi">4325000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Make another plot to zoom in on snow pit 2S10:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">aster_band14_tb_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                       <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                       <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ASTER IR&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>


<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                 <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne IR&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># for each subplot, do the following:</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>
    
    <span class="c1"># plot the location of the snow pit of interest</span>
    <span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="c1"># plot the area of the buffer we made around the snow pit</span>
    <span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    
    <span class="c1"># set axes labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>
    <span class="c1"># set the same axes limits as above</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># x axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># y axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Get the temperature of the ASTER pixel at the snow pit point using rioxarray <a class="reference external" href="https://corteva.github.io/rioxarray/stable/examples/clip_geom.html">clip</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First clip to the single point</span>
<span class="n">aster_band14_tb_c_point_temperature</span> <span class="o">=</span> <span class="n">aster_band14_tb_c</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">siteData_df</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>

<span class="c1"># Second clip to the 100 m radius buffered area</span>
<span class="n">aster_band14_tb_c_area_temperature</span> <span class="o">=</span> <span class="n">aster_band14_tb_c</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>

<span class="c1"># preview the result</span>
<span class="n">aster_band14_tb_c_area_temperature</span>
</pre></div>
</div>
</div>
</div>
<p>How many ASTER pixels in the area did we select?</p>
<p>Plot the clipped area:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># plot the portion of the airborne TIR image we selected within the buffer area geometry</span>
<span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">7</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ASTER TIR image within</span><span class="se">\n</span><span class="s1">100 m radius buffer (2S10)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">150</span><span class="p">))</span> <span class="c1"># x axis limits to +/- 150 m from our point&#39;s &quot;total bounds&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">150</span><span class="p">))</span> <span class="c1"># y axis limits to +/- 150 m from our point&#39;s &quot;total bounds&quot;</span>

<span class="c1"># plot the location of the snow pit of interest to the plot</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># plot the area of the buffer we made around the snow pit</span>
<span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="c1"># plot a histogram of image temperature data within the buffer area geometry</span>
<span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># set xlim to same values as colorbar in image plot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram of temperatures from ASTER TIR image</span><span class="se">\n</span><span class="s1">100 m radius buffer (2S10)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of pixels&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Plot the ASTER IR temperature data on top of the ground-based timeseries and airborne IR temperature</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># plot radiometer average temperature</span>
<span class="n">df</span><span class="o">.</span><span class="n">rad_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ground-based $T_s$&#39;</span><span class="p">)</span>

<span class="c1"># plot the mean airborne IR temperature from the area around the snow pit:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">airborne_ir_timestamp</span><span class="p">,</span> <span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Airborne IR mean $T_s$ for 100 m radius area&#39;</span><span class="p">)</span>
<span class="c1"># plot an error bar showing the maximum and minimum airborne IR temperature around the snow pit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">airborne_ir_timestamp</span><span class="p">,</span> <span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
             <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">min</span><span class="p">()],</span> 
                   <span class="p">[</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">airborne_ir_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()]],</span>
            <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
            <span class="p">)</span><span class="c1">#label=&#39;Airborne IR $T_s$ range for 100 m radius area&#39;)</span>

<span class="c1"># plot the mean ASTER IR temperature from the area around the snow pit:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">aster_ir_timestamp</span><span class="p">,</span> <span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ASTER IR mean $T_s$ for 100 m radius area&#39;</span><span class="p">)</span>
<span class="c1"># plot an error bar showing the maximum and minimum ASTER IR temperature around the snow pit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">aster_ir_timestamp</span><span class="p">,</span> <span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
             <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">min</span><span class="p">()],</span> 
                   <span class="p">[</span><span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">aster_band14_tb_c_area_temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()]],</span>
            <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
            <span class="p">)</span><span class="c1">#label=&#39;ASTER IR $T_s$ range for 100 m radius area&#39;)</span>


<span class="c1"># set axes limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="c1"># zoom in to daytime hours on Feb. 8, 2020</span>

<span class="c1"># add a legend to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># set axes labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$C\degree$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

<span class="c1"># add grid lines to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>

<span class="c1"># set the plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Snow Surface Temperature at Snow Pit 2S10&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="bonus-activity-comparing-two-thermal-ir-rasters">
<h3>Bonus activity: comparing two thermal IR rasters<a class="headerlink" href="#bonus-activity-comparing-two-thermal-ir-rasters" title="Permalink to this headline">¶</a></h3>
<p>How does the finer spatial resolution airborne IR image compare with the coarser resolution ASTER IR image?</p>
<p>One way to compare these two images is to “upscale” the finer resolution airborne IR image to the same spatial resolution as ASTER.</p>
<p>We can use the rioxarray <a class="reference external" href="https://corteva.github.io/rioxarray/stable/rioxarray.html#rioxarray.raster_array.RasterArray.reproject_match">reproject_match</a> function to do this. (<a class="reference external" href="https://corteva.github.io/rioxarray/stable/examples/reproject_match.html">also see this example</a>)</p>
<p>Note that this function has <a class="reference external" href="https://rasterio.readthedocs.io/en/stable/api/rasterio.enums.html#rasterio.enums.Resampling">multiple options</a> for how we want to resample the image data to the new spatial resolution. We will use <code class="docutils literal notranslate"><span class="pre">resampling=5</span></code> which corresponds to taking the mean value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_ir_repr</span> <span class="o">=</span> <span class="n">airborne_ir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">reproject_match</span><span class="p">(</span><span class="n">aster_ir</span><span class="p">,</span> <span class="n">resampling</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Preview the result.</p>
<ul class="simple">
<li><p>What are the image dimensions of the reprojected airborne IR image compared with the original?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airborne_ir_repr</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the ASTER image, original airborne IR image, and resampled airborne IR image next to each other to visualize these spatial resolution differences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ASTER IR image</span>
<span class="n">aster_band14_tb_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                       <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                       <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ASTER IR&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Original airborne IR image</span>
<span class="n">airborne_ir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                 <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                 <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne IR&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Resampled airborne IR image</span>
<span class="n">airborne_ir_repr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                      <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> 
                      <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                      <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Airborne IR resampled (mean)</span><span class="se">\n</span><span class="s1">to ASTER resolution (90m)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>


<span class="c1"># for each subplot, do the following:</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># set the aspect ratio to &quot;equal&quot;</span>
    
    <span class="c1"># plot the location of the snow pit of interest</span>
    <span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="c1"># plot the area of the buffer we made around the snow pit</span>
    <span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    
    <span class="c1"># set axes labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>
    <span class="c1"># set the same axes limits as above</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># x axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># y axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, compute the difference between the ASTER IR image and resampled airborne IR image, then plot the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subtract reprojected airborne IR image from ASTER IR image</span>
<span class="n">difference_image</span> <span class="o">=</span> <span class="n">aster_band14_tb_c</span> <span class="o">-</span> <span class="n">airborne_ir_repr</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Difference image</span>
<span class="n">difference_image</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> 
                       <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                       <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature $\degree C$&#39;</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature Difference</span><span class="se">\n</span><span class="s1">(ASTER IR - Reprojected Airborne IR)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># plot the location of the snow pit of interest</span>
<span class="n">siteData_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="c1"># plot the area of the buffer we made around the snow pit</span>
<span class="n">siteData_df_buffer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="c1"># set axes labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eastings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northings UTM 12N (m)&#39;</span><span class="p">)</span>
<span class="c1"># set the same axes limits as above</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">1000</span><span class="p">))</span> <span class="c1"># x axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">1000</span><span class="p">));</span> <span class="c1"># y axis limits to +/- 1 km from our point&#39;s &quot;total bounds&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="next-steps">
<h1>Next steps:<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h1>
<div class="section" id="project-ideas-with-these-data">
<h2>Project ideas with these data:<a class="headerlink" href="#project-ideas-with-these-data" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Compare more snow pit temperature data (using snowexsql queries) against airborne and satellite IR imagery</p></li>
<li><p>Investigate spatial patterns of snow temperature from open areas to forested areas on the mesa, differences between ASTER and airborne IR imagery</p></li>
<li><p>Improved data visualization using <a class="reference external" href="https://hvplot.holoviz.org/">hvplot</a> or something similar to create interactive plots of IR and/or visible imagery</p></li>
<li><p>Compare thermal infrared and SAR imagery, or snow temperature observations and snow model outputs</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>Contact Steven Pestana during the hackweek for help accessing more airborne IR or visible imagery and related datasets</em></p>
</div>
</div>
<div class="section" id="data-access-download-and-pre-processing">
<h2>Data access/download and pre-processing<a class="headerlink" href="#data-access-download-and-pre-processing" title="Permalink to this headline">¶</a></h2>
<p>See the jupyter notebook <a class="reference internal" href="thermal-ir-data-download.html"><span class="doc std std-doc">thermal-ir-data-download.ipynb</span></a> for more details about data access methods through the NASA EarthData API, and pre-processing ASTER data into geotiff images.</p>
</div>
<div class="section" id="additional-learning-resources">
<h2>Additional learning resources:<a class="headerlink" href="#additional-learning-resources" title="Permalink to this headline">¶</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><strong><a class="reference external" href="https://numpy.org">NumPy</a> learning resources:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/waterhackweek/waterdata/blob/master/gridded_data_tutorial_0.ipynb">NumPy and the ndarray</a></p></li>
<li><p><a class="reference external" href="https://numpy.org/devdocs/user/absolute_beginners.html">NumPy: the absolute basics for beginners</a></p></li>
<li><p><a class="reference external" href="https://scipy-lectures.org/intro/numpy/index.html">NumPy: creating and manipulating numerical data</a></p></li>
<li><p><a class="reference external" href="https://scipy-lectures.org/advanced/advanced_numpy/index.html">Advanced NumPy</a></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/user/numpy-for-matlab-users.html">NumPy for MATLAB users</a></p></li>
</ul>
<p><strong><a class="reference external" href="https://xarray.pydata.org/en/stable/">Xarray</a> and <a class="reference external" href="https://corteva.github.io/rioxarray/stable/">rioxarray</a> learning resources:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/waterhackweek/waterdata/blob/master/gridded_data_tutorial_1.ipynb">Introduction to xarray</a></p></li>
<li><p><a class="reference external" href="https://github.com/geohackweek/raster-2019">GeoHackWeek 2019 raster tools</a></p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/">rasterio</a></p></li>
<li><p><a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">cartopy</a></p></li>
</ul>
<p><strong><a class="reference external" href="https://asterweb.jpl.nasa.gov/">ASTER</a> resources:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://git.earthdata.nasa.gov/projects/LPDUR/repos/aster-l1t/browse">ASTER L1T Scripts and Tutorials</a></p></li>
<li><p><a class="reference external" href="https://github.com/UW-GDA/aster-thermal/">Validating ASTER Thermal Infrared Imaging for use in Snow Models</a></p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/thermal-ir"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Thermal Infrared Remote Sensing of Snow</a>
    <a class='right-next' id="next-link" href="thermal-ir-data-download.html" title="next page">Downloading datasets for the thermal IR tutorial</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By eScience Institute, University of Washington<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QM84T4SB76"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('config', 'G-QM84T4SB76');
                </script>

  </body>
</html>